<view class='item'>
  <zan-panel>
    <view class='item-content' catchtap="goOrderDetail">
      <view class='top-info'>
        <view class='left'>{{data.create_time}}</view>
        <template is="pay-actions" data="{{...data}}" />
      </view>
      <view class='center-info' catchtap="goGoodsDetail" data-id="{{item.goods_id}}" wx:for="{{data.order_goods_info}}" wx:key="key">
        <view class='image-warpper'>
          <image class='image' src='{{item.thum}}' mode="widthFix"></image>
        </view>
        <view class='title-warpper'>
          <view class='title zan-ellipsis--l2'>{{item.name}}</view>
          <view class='sku'>规格: {{item.spec_group_info?item.spec_group_info:'无'}}</view>
        </view>
        <view class='price-warpper'>
          <view class='price'>
            <view class='class-real-price'>
              <text class="class-price-icon">￥</text>{{item.real_price}}</view>
            <view wx:if="{{data.market_activity_type != 0}}" class='class-sell-price'>
              <text class="class-price-icon">￥</text>{{item.sell_price}}</view>
          </view>
          <view class='class-goods-num'>x {{item.num}}</view>
          <block wx:if="{{data.status == 2 || data.status == 3 }}">
            <template is="refound" data="{{...item}}" />
          </block>
          <block wx:if="{{data.status == 4 }}">
            <block wx:if="{{item.return_goods_status == 3 }}">
              <template is="refound" data="{{...item}}" />
            </block>
            <block wx:if="{{item.return_goods_status != 3 }}">
              <template is="estimate" data="{{goods:item, index:index}}" />
            </block>
          </block>
        </view>
      </view>
      <view class='bottom-info'>
        <view class='all-price' wx:if="{{haveinfo}}">
          <text>共 {{data.order_goods_info.length}} 件商品 合计: </text>
          <text class='class-real-price'><text class="class-price-icon">￥</text>{{data.total_money}}</text>
          <text> (含运费：<text class="class-price-icon">￥</text>{{data.freight_money}})</text>
        </view>
        <template is="finsh-actions" data="{{...data}}" />
      </view>
    </view>
  </zan-panel>
</view>

<!-- 大按钮模板 -->
<template name="finsh-actions">
  <!-- 待付款 -->
  <view wx:if="{{status === 1}}" class='click-button'>
    <button catchtap='cancelOrder' class='button' size="small">取消订单</button>
    <button catchtap='payOrder' type="info" class='button button-red' size="small">立即付款</button>
  </view>
  <!-- 待发货 -->
  <view wx:if="{{status === 2}}" class='click-button'>
    <button catchtap="tipOrder" type="info" class='button' size="small">提醒发货</button>
  </view>
  <!-- 待收货  -->
  <view wx:if="{{status === 3}}" class='click-button'>
    <button class='button' catchtap='goExpress' size="small">查看物流</button>
    <button class='button button-red' type="info" catchtap="userSing" size="small">确认收货</button>
  </view>
  <!-- 待评价 无退款 / 退款成功不显示 -->
  <!-- <block wx:if="{{is_has_return_goods===0}}">
    <view wx:if="{{status === 4}}" class='click-button'>
      <zan-button class='zan-button' size="small" catchtap='goExpress'>查看物流</zan-button>
    </view>
  </block> -->

</template>


<!-- 小退款按钮 -->
<template name="refound">
  <view class='action'>
    <button class="s-button" wx:if="{{return_goods_status===0}}" catchtap='refundOrder' data-id="{{goods_id}}"> 退款 </button>
    <view wx:if="{{return_goods_status===1}}"> 退货申请中 </view>
    <view wx:if="{{return_goods_status===2}}"> 退货已拒绝 </view>
    <view wx:if="{{return_goods_status===3 && is_return_money == 0}}">退货成功(未退款) </view>
    <view wx:if="{{return_goods_status===3 && is_return_money == 1}}"> 退款成功(已退款) </view>
  </view>
</template>
<!-- 评价按钮 -->
<template name="estimate">
  <view class='action'>
    <button wx:if="{{goods.is_comment===0}}" data-index="{{index}}" type="info" class='s-button' catchtap='estimateGoods'> 评价 </button>
    <!-- <view wx:else> 已评价 </view> -->
  </view>
</template>


<!-- 付款状态 -->
<template name="pay-actions">
  <view wx:if="{{status === 1}}" class='right'>等待付款</view>
  <view wx:if="{{status === 2}}" class='right'>等待发货</view>
  <view wx:if="{{status === 3}}" class='right'>已发货</view>
  <view wx:if="{{status === 4}}" class='right'>交易完成</view>
  <view wx:if="{{status === 9}}" class='right'>交易关闭</view>
</template>

<view wx:if="{{noContent}}" style="text-align: center;margin-top: 20%;">
  <image mode="widthFix" src="{{noContentImg}}" style="width: 18%;margin: 0 auto;"></image>
  <view style="color: #777;">啊哦,这里什么都没有~</view>
</view>


<modal hidden="{{hiddenmodalput}}" title="请输入原因" confirm-text="确认" cancel-text="取消" bindcancel="modalCancel" bindconfirm="modalConfirm">
  <block wx:if="{{!hiddenmodalput}}">
    <input bindinput="bindInput" type='text' placeholder="请输入内容" />
  </block>
</modal>